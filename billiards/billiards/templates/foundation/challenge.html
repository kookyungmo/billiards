{% extends "foundation/base.html" %}
{% load url from future %}
{% block header %}
{% load staticfiles %}
<script type="text/javascript"
	src="http://api.map.baidu.com/api?v=2.0&ak=5aaddbae69513573cd7f693bbdcbe12a"></script>
<script src="http://cdnjscn.b0.upaiyun.com/libs/moment.js/2.6.0/moment-with-langs.min.js"></script>
<script src="{% static "js/map_ui2.js" %}?{{buildid}}"></script>
<script src="{% static "js/mustache.js" %}?0.8.1"></script>
<script language="javascript">var STATIC_URL = "{{ STATIC_URL|escapejs }}"; var MEDIA_URL = "{{ MEDIA_URL }}"; var LOGO_URL="{{ SITE_LOGO_URL }}"; var WECHAT_SHARE_URL="{% url 'wechat_share_help' %}";</script>
<script src="{% static "js/WeixinApi.js" %}?{{buildid}}"></script>
<script src="{% static "js/wechat.js" %}?{{buildid}}"></script>
<link href="http://cdnjscn.b0.upaiyun.com/libs/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
<link href="{% static "foundation-icons/foundation-icons.css" %}" rel="stylesheet">
{% endblock %}
{% load extras %}
{% block content %}
<div>
	<div class="clearfix">
		<div class="large-8 columns">
			<h2 class="fi-torsos-all">{% if group != None %}<code>{{group.name}}</code>群内{% endif %}约球信息</h2><h4><b>抢台费</b>新玩法，发送你的位置到"{{group.name|default:"我为台球狂"}}"微信帐号发起抢台费。</h4>
		</div>
		<div id="viewSwitch" class="large-4 columns show-for-medium-up">
			<a href="#" class="active list"><i class="fa fa-th-large"></i> 列表</a> 
			<a href="#" class="map"><i class="fa fa-globe"></i> 地图</a>
		</div>
	</div>
	<hr>
	<div id="content">
	</div>
	<div>
		<div id="items"></div>
		<div id="mapContainer" class="hidden medium-9 columns"><div id="pkMap"></div></div>
	</div>
</div>
{% endblock %}
{% block script %}
<div id="shareToWechat" class="reveal-modal xlarge" data-reveal>
</div>
	<script>
	{% if lat != None %}
	var mypoint = new BMap.Point({{lng}}, {{lat}});
	{% else %}
	var mypoint = null;
	{% endif %}
	CHALLENGE_URL = window.location.pathname;
	CHALLENGE_DETAIL_URL = "{% url 'challenge_detail' '000' %}";
	CHALLENGE_WITH_DISTANCE_URL = "{% url 'challenge_with_distance' gid '00.00' '11.11' %}";
	POOLROOM_URL = "{% url 'poolroom_detail' '000' %}";
	CHALLENGE_APPLY_URL = "{% url 'apply_challenge' '000' %}";
	
	createInfo("正在加载约球信息...");
	
	var defaultZoom = 12;

	var pkMap = new PKMap("pkMap", "北京", defaultZoom);
	var pkLocation = new PKLocation(mypoint);
	var pkChallenges = new PKChallenges(pkMap);
	pkLocation.consume(
		pkMap.markCurrentLocation,
		pkChallenges.loadChallenges(mypoint)
	);
	
	setUpViewSwitch();
	</script>
{% endblock %}	
